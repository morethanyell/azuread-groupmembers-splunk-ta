{"basic_builder": {"appname": "TA-azure-group-member-insight", "friendly_name": "Azure Group Member Insight", "version": "1.0.0", "author": "morethanyell", "description": "Efficiently collects Azure AD group members using specified group display name search keyword", "theme": "#2b7cd2", "large_icon": "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", "small_icon": "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", "visible": true, "tab_version": "4.2.0", "tab_build_no": "0", "build_no": 1}, "data_input_builder": {"datainputs": [{"index": "default", "sourcetype": "azure:aad:user:asmemberof", "interval": "86400", "use_external_validation": true, "streaming_mode_xml": true, "name": "get_group_members", "title": "Get Group Members", "description": "Retrieve the Group's members", "type": "customized", "parameters": [{"name": "group_display_name_keyword", "label": "Group Display Name Keyword", "help_string": "Enter a non-RegEx pattern for a Group's Display Name. E.g.: \"MFA-Bypassers\". This will retrieve groups that contain \"MFA=-Bypassers\" in the displayName property", "required": true, "format_type": "text", "default_value": "", "placeholder": "", "type": "text", "value": "MFA-Exception"}, {"name": "global_account", "label": "Global Account", "help_string": "", "required": true, "possible_values": [], "format_type": "global_account", "default_value": "", "placeholder": "", "type": "global_account", "value": "account0"}, {"name": "tenant_id", "label": "Tenant ID", "help_string": "", "required": false, "format_type": "text", "default_value": "", "placeholder": "", "type": "text", "value": "e2ba81b8-03fe-407c-96a1-f4bc0f512e7d"}], "data_inputs_options": [{"type": "customized_var", "name": "group_display_name_keyword", "title": "Group Display Name Keyword", "description": "Enter a non-RegEx pattern for a Group's Display Name. E.g.: \"MFA-Bypassers\". This will retrieve groups that contain \"MFA=-Bypassers\" in the displayName property", "required_on_edit": false, "required_on_create": true, "format_type": "text", "default_value": "", "placeholder": ""}, {"type": "customized_var", "name": "global_account", "title": "Global Account", "description": "", "required_on_edit": false, "required_on_create": true, "possible_values": [], "format_type": "global_account", "default_value": "", "placeholder": ""}, {"type": "customized_var", "name": "tenant_id", "title": "Tenant ID", "description": "", "required_on_edit": false, "required_on_create": false, "format_type": "text", "default_value": "", "placeholder": ""}], "code": "\n# encoding = utf-8\n\nimport requests\nimport json\n\n'''\n    IMPORTANT\n    Edit only the validate_input and collect_events functions.\n    Do not edit any other part in this file.\n    This file is generated only once when creating the modular input.\n'''\n'''\n# For advanced users, if you want to create single instance mod input, uncomment this method.\ndef use_single_instance_mode():\n    return True\n'''\n\ndef validate_input(helper, definition):\n    \"\"\"Implement your own validation logic to validate the input stanza configurations\"\"\"\n    # This example accesses the modular input variable\n    # group_display_name_keyword = definition.parameters.get('group_display_name_keyword', None)\n    # global_account = definition.parameters.get('global_account', None)\n    # tenant_id = definition.parameters.get('tenant_id', None)\n    pass\n\ndef get_bearer_token(helper, client_id, client_secret, tenant_id):\n    \n    token_url = f'https://login.microsoftonline.com/{tenant_id}/oauth2/v2.0/token'\n    \n    data = {\n        'grant_type': 'client_credentials',\n        'client_id': client_id,\n        'client_secret': client_secret,\n        'scope': 'https://graph.microsoft.com/.default'\n    }\n    \n    try:\n        \n        helper.log_info(\"Obtaining access token...\")\n        \n        response = requests.post(token_url, data=data)\n        response.raise_for_status()\n        token_info = response.json()\n        \n        helper.log_info(f\"Access token for client id {client_id} has been granted...\")\n        \n        return token_info['access_token']\n    except requests.RequestException as e:\n        helper.log_error(f\"Error obtaining token: {e}\")\n        return None\n\ndef get_search_matched_groups(helper, access_token, keyword):\n    \n    graph_url = 'https://graph.microsoft.com/v1.0/'\n    groups = graph_url + f'groups/?$search=\"displayName:{keyword}\"'\n    \n    headers = {\n        'Authorization': 'Bearer ' + access_token,\n        'Content-Type': 'application/json',\n        'ConsistencyLevel': 'eventual'\n    }\n\n    all_groups = []\n    \n    helper.log_info(f'Retrieving all groups matching \"{keyword}\". Full API uri and params: GET {groups}')\n\n    response = requests.get(groups, headers=headers)\n    \n    page_counter = 1\n\n    if response.status_code == 200:\n        group_members_details = response.json()\n        all_groups.extend(group_members_details['value'])\n\n        while '@odata.nextLink' in group_members_details:\n            \n            page_counter = page_counter + 1\n            \n            if page_counter == 2:\n                helper.log_info(f\"Groups that match {keyword} have multiple pages.\")\n            \n            next_link = group_members_details['@odata.nextLink']\n            response = requests.get(next_link, headers=headers)\n            \n            if response.status_code == 200:\n                group_members_details = response.json()\n                all_groups.extend(group_members_details['value'])\n            else:\n                helper.log_error(f'Error occurred. Status={str(response.status_code)}', response.text)\n                continue\n        \n        if page_counter > 1:\n            helper.log_info(f\"Finished collecting Groups that match {keyword} at page {str(page_counter)}.\")\n        \n        return all_groups\n        \n    else:\n        helper.log_error(f'Error occurred. Status={str(response.status_code)}', response.text)\n        \n\ndef get_group_members(helper, access_token, group_id):\n    \n    graph_url = 'https://graph.microsoft.com/v1.0/'\n    group_members_url = graph_url + f'groups/{group_id}/members?$select=id,userPrincipalName,displayName,jobTitle,accountEnabled'\n\n    headers = {\n        'Authorization': 'Bearer ' + access_token,\n        'Content-Type': 'application/json'\n    }\n\n    all_group_members_details = []\n    \n    helper.log_info(f\"Retrieving members of {group_id}\")\n\n    response = requests.get(group_members_url, headers=headers)\n    \n    page_counter = 1\n\n    if response.status_code == 200:\n        group_members_details = response.json()\n        all_group_members_details.extend(group_members_details['value'])\n\n        while '@odata.nextLink' in group_members_details:\n            \n            page_counter = page_counter + 1\n            \n            if page_counter == 2:\n                helper.log_info(f\"Group {group_id} has multiple pages.\")\n            \n            next_link = group_members_details['@odata.nextLink']\n            response = requests.get(next_link, headers=headers)\n            if response.status_code == 200:\n                group_members_details = response.json()\n                all_group_members_details.extend(group_members_details['value'])\n            else:\n                helper.log_error(f'Error occurred. Status={str(response.status_code)}', response.text)\n                continue\n        \n        if page_counter > 1:\n            helper.log_info(f\"Group {group_id} ended collecting all members at page {str(page_counter)}.\")\n        \n        return all_group_members_details\n\n    else:\n        helper.log_error(f'Error occurred. Status={str(response.status_code)}', response.text)\n\n\ndef collect_events(helper, ew):\n    \n    opt_global_account = helper.get_arg('global_account')\n    client_id = opt_global_account['username']\n    client_secret = opt_global_account['password']\n    tenant_id = helper.get_arg('tenant_id')\n    gdnsk = helper.get_arg('group_display_name_keyword')\n    \n    llvl = helper.get_log_level()\n    \n    helper.set_log_level(llvl)\n    \n    helper.log_info(f\"Loging level is set to: {llvl}\")\n    \n    helper.log_info(f\"Members of group matching '{gdnsk}'. Start of collection.\")\n    \n    token = get_bearer_token(helper, client_id, client_secret, tenant_id)\n    \n    matched_groups = get_search_matched_groups(helper, token, gdnsk)\n    \n    total_groups = len(matched_groups)\n    \n    if total_groups < 1: \n        helper.log_warning(f'No groups matched the keyword \"{gdnsk}\". Disable this collection method or change the keyword. End of collection.')\n        return None\n    \n    helper.log_info(f\"Collected {str(total_groups)} Groups. Retrieval of members from each group begins here...\")\n    \n    meta_source = f\"ms_aad_user:tenant_id:{tenant_id}\"\n    \n    for group in matched_groups:\n        \n        gid = group['id']\n        dn = group['displayName']\n        current_group = get_group_members(helper, token, gid)\n        \n        total_members = len(current_group)\n        \n        if total_members < 1: \n            helper.log_warning(f\"Group {gid} has no members. Skipping this.\")\n            continue\n        \n        for cg in current_group:\n            cg['memberOfGroupId'] = gid\n            cg['memberOfGroupDisplayName'] = dn\n            \n            data_event = json.dumps(cg, separators=(',', ':'))\n            event = helper.new_event(source=meta_source, index=helper.get_output_index(), sourcetype=helper.get_sourcetype(), data=data_event)\n            ew.write_event(event)\n    \n    helper.log_info(f\"Ingestion of all users was successful. End of collection.\")\n        \n", "customized_options": [{"name": "group_display_name_keyword", "value": "FD3giv3lmdfnvb3 vo23r nv2ofnv2 ov"}, {"name": "global_account", "value": "account0"}, {"name": "tenant_id", "value": "e2ba81b8-03fe-407c-96a1-f4bc0f512e7d"}], "uuid": "89c70065a8ce4b1f8fcce151dcf4eb54", "sample_count": "75381"}]}, "field_extraction_builder": {"azure:aad:user:asmemberof": {"data_format": "json"}}, "global_settings_builder": {"global_settings": {"log_settings": {"log_level": "DEBUG"}, "credential_settings": []}}, "sourcetype_builder": {"azure:aad:user:asmemberof": {"metadata": {"event_count": 0, "data_input_name": "get_group_members", "extractions_count": 0, "cims_count": 0}}}, "validation": {"validators": ["best_practice_validation", "data_model_mapping_validation", "field_extract_validation", "app_cert_validation"], "status": "job_started", "validation_id": "v_1720031023_18"}}